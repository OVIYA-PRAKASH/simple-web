<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Blood Donation System — Single Page</title>
  <style>
    :root{
      --accent:#c8102e;
      --muted:#f5f5f5;
      --card:#ffffff;
      --text:#222;
      --glass: rgba(255,255,255,0.85);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:Inter, system-ui, Arial, sans-serif;
      background:linear-gradient(180deg,#fff 0%, #f7f7f7 100%);
      color:var(--text);
      padding:20px;
    }
    .container{max-width:980px;margin:0 auto;}
    header{
      display:flex;align-items:center;gap:16px;
      margin-bottom:18px;
    }
    .logo{
      width:56px;height:56px;border-radius:8px;
      background:var(--accent);color:white;display:flex;
      align-items:center;justify-content:center;font-weight:700;
      font-size:20px;box-shadow:0 6px 18px rgba(200,0,40,0.12);
    }
    h1{margin:0;font-size:20px}
    p.lead{margin:6px 0 0;color:#555;font-size:14px}

    .search {
      display:flex;gap:12px;margin:18px 0 24px;flex-wrap:wrap;
    }
    select,input[type="text"],button{
      padding:10px 12px;border-radius:8px;border:1px solid #ddd;
      font-size:14px;background:white;
    }
    button.primary{
      background:var(--accent);color:white;border:0;cursor:pointer;
    }
    .grid{
      display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));
      gap:14px;
    }

    .card{
      background:var(--card);padding:14px;border-radius:10px;
      box-shadow:0 6px 18px rgba(0,0,0,0.04);display:flex;flex-direction:column;
      gap:8px;
    }
    .donor-top{display:flex;align-items:center;gap:10px}
    .avatar{
      width:48px;height:48px;border-radius:8px;background:var(--muted);
      display:flex;align-items:center;justify-content:center;font-weight:700;color:#555;
    }
    .donor-name{font-weight:700}
    .meta{font-size:13px;color:#666}
    .blood{margin-left:auto;padding:6px 10px;border-radius:8px;background:rgba(200,16,46,0.08);color:var(--accent);font-weight:700}
    .actions{display:flex;gap:8px;margin-top:8px}
    .btn{padding:8px 10px;border-radius:8px;border:1px solid #ddd;background:white;cursor:pointer;font-size:13px}
    .btn.call{border-color:rgba(0,140,60,0.12);color:#046637}
    .btn.msg{border-color:rgba(0,80,180,0.12);color:#064a8a}

    .no-results{padding:20px;background:#fff3f4;border:1px solid #ffd6dc;color:#a10b28;border-radius:8px;text-align:center}

    footer{margin:28px 0 10px;color:#666;font-size:13px;text-align:center}

    /* Contact form */
    .form-row{display:flex;gap:10px}
    .form-row .col{flex:1}
    input,textarea{width:100%}
    textarea{min-height:100px;resize:vertical}

    @media (max-width:560px){
      header{gap:10px}
      .logo{width:48px;height:48px;font-size:18px}
      h1{font-size:18px}
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="logo">BD</div>
      <div>
        <h1>Blood Donation System</h1>
        <p class="lead">Find nearby voluntary donors by blood group and city — connect quickly.</p>
      </div>
    </header>

    <section aria-label="search donors">
      <div class="search" role="search">
        <select id="bloodSelect" aria-label="Filter by blood group">
          <option value="">All Blood Groups</option>
          <option>A+</option><option>A-</option><option>B+</option><option>B-</option>
          <option>O+</option><option>O-</option><option>AB+</option><option>AB-</option>
        </select>

        <input id="cityInput" type="text" placeholder="Enter city (e.g., Chennai)" aria-label="Filter by city">

        <button id="filterBtn" class="primary">Search</button>
        <button id="resetBtn" title="Show all">Reset</button>
      </div>
    </section>

    <section id="results" aria-live="polite">
      <div id="list" class="grid"></div>
    </section>

    <section style="margin-top:22px">
      <h2 style="margin:0 0 12px">Register as Donor (Demo)</h2>
      <div class="card">
        <form id="registerForm" onsubmit="return false;">
          <div class="form-row">
            <div class="col"><input id="rname" placeholder="Your name" required></div>
            <div class="col"><input id="rblood" placeholder="Blood Group (e.g., O+)" required></div>
          </div>
          <div class="form-row" style="margin-top:8px">
            <div class="col"><input id="rcity" placeholder="City (e.g., Mumbai)" required></div>
            <div class="col"><input id="rphone" placeholder="Phone (optional)"></div>
          </div>
          <div style="margin-top:8px">
            <textarea id="rnotes" placeholder="Any notes (optional)"></textarea>
          </div>
          <div style="margin-top:10px;display:flex;gap:8px;align-items:center">
            <button class="btn primary" id="registerBtn">Add as Donor</button>
            <span style="font-size:13px;color:#666">This demo only stores data in your browser (no server).</span>
          </div>
        </form>
      </div>
    </section>

    <footer>
      Tip: Edit the static donor list inside the code to add more donors. Use the register form to add donors locally.
    </footer>
  </div>

  <script>
    // Sample static donors (you can edit/add)
    const defaultDonors = [
      { id:1, name:"Arjun Kumar", blood:"O+", city:"Chennai", phone:"+91-9876543210", notes:"Volunteer" },
      { id:2, name:"Sita R", blood:"B+", city:"Bengaluru", phone:"+91-9123456780", notes:"Available weekends" },
      { id:3, name:"Manoj Patel", blood:"A-", city:"Ahmedabad", phone:"+91-9988776655", notes:"Near city hospital" },
      { id:4, name:"Fatima Noor", blood:"AB+", city:"Hyderabad", phone:"+91-9001122334", notes:"First time donor" },
      { id:5, name:"Priya Sen", blood:"O-", city:"Chennai", phone:"+91-9800011223", notes:"Regular donor" }
    ];

    // Keep donors in memory (local session). For persistence across reloads, you could use localStorage.
    let donors = JSON.parse(localStorage.getItem('bd_donors')) || defaultDonors.slice();

    const listEl = document.getElementById('list');
    const bloodSelect = document.getElementById('bloodSelect');
    const cityInput = document.getElementById('cityInput');
    const filterBtn = document.getElementById('filterBtn');
    const resetBtn = document.getElementById('resetBtn');
    const registerBtn = document.getElementById('registerBtn');

    function renderDonors(items) {
      listEl.innerHTML = "";
      if (!items.length) {
        listEl.innerHTML = '<div class="no-results">No donors found. Try another city or blood group.</div>';
        return;
      }
      items.forEach(d => {
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
          <div class="donor-top">
            <div class="avatar">${d.name.split(' ').map(s=>s[0]).slice(0,2).join('')}</div>
            <div>
              <div class="donor-name">${escapeHtml(d.name)}</div>
              <div class="meta">${escapeHtml(d.city)} • ${escapeHtml(d.notes||'')}</div>
            </div>
            <div class="blood">${escapeHtml(d.blood)}</div>
          </div>
          <div class="meta">Phone: ${d.phone ? `<a href="tel:${encodeURIComponent(d.phone)}">${escapeHtml(d.phone)}</a>` : 'Not provided'}</div>
          <div class="actions">
            <button class="btn call" onclick="contactDonor('${encodeURIComponent(d.name)}','${encodeURIComponent(d.phone||'')}')">Call</button>
            <button class="btn msg" onclick="messageDonor('${encodeURIComponent(d.name)}')">Message</button>
          </div>
        `;
        listEl.appendChild(card);
      });
    }

    // Utilities
    function escapeHtml(str){ if(!str) return ''; return String(str).replace(/[&<>"']/g, s=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;' })[s]); }

    function contactDonor(nameEnc, phoneEnc){
      const name=decodeURIComponent(nameEnc);
      const phone=decodeURIComponent(phoneEnc);
      if(phone) {
        // try tel link
        window.location.href = `tel:${phone}`;
      } else {
        alert(`${name} has not shared a phone number.`);
      }
    }
    function messageDonor(nameEnc){
      const name=decodeURIComponent(nameEnc);
      alert(`Open your messaging app to contact ${name}.\n(This is a demo.)`);
    }

    // Filtering
    function filterDonors(){
      const bg = bloodSelect.value.trim().toUpperCase();
      const city = cityInput.value.trim().toLowerCase();
      let res = donors.filter(d=>{
        const matchBG = !bg || (d.blood && d.blood.toUpperCase() === bg);
        const matchCity = !city || (d.city && d.city.toLowerCase().includes(city));
        return matchBG && matchCity;
      });
      renderDonors(res);
    }

    filterBtn.addEventListener('click', filterDonors);
    cityInput.addEventListener('keydown', (e)=>{ if(e.key === 'Enter') filterDonors(); });
    resetBtn.addEventListener('click', ()=>{ bloodSelect.value=''; cityInput.value=''; renderDonors(donors); });

    // Register (add donor locally)
    document.getElementById('registerForm').addEventListener('submit', (e)=>{
      e.preventDefault();
      const name = document.getElementById('rname').value.trim();
      const blood = document.getElementById('rblood').value.trim().toUpperCase();
      const city = document.getElementById('rcity').value.trim();
      const phone = document.getElementById('rphone').value.trim();
      const notes = document.getElementById('rnotes').value.trim();
      if(!name || !blood || !city){ alert('Please fill name, blood group and city.'); return; }
      const newDonor = { id: Date.now(), name, blood, city, phone, notes };
      donors.unshift(newDonor);
      localStorage.setItem('bd_donors', JSON.stringify(donors));
      // clear form
      document.getElementById('rname').value=''; document.getElementById('rblood').value=''; document.getElementById('rcity').value=''; document.getElementById('rphone').value=''; document.getElementById('rnotes').value='';
      renderDonors(donors);
      alert('Thanks! Your donor record was added locally in this browser.');
    });

    // initial render
    renderDonors(donors);
  </script>
</body>
</html>
